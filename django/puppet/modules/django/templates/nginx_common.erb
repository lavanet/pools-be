#
# !!! THIS FILE IS MAINTAINED BY PUPPET !!!
#

client_max_body_size 512M;
sendfile on;

access_log off;
error_log  off;

location /media/ {
    alias   <%= @path %>/media/;
    expires 1d;
}

location /static/ {
    alias   <%= @path %>/static/;
    expires 365d;
}

location /favicon.ico {
    alias   <%= @path %>/static/favicon.ico;
    expires 365d;
}

location / {
    access_log <%= @site_path %>/access.log;
    error_log  <%= @site_path %>/error.log;

    include uwsgi_params;
    uwsgi_pass    django-<%= @project %>;
    uwsgi_param   Host                 $http_host;
    uwsgi_param   X-Real-IP            $remote_addr;
    uwsgi_param   X-Forwarded-For      $proxy_add_x_forwarded_for;
    uwsgi_param   X-Forwarded-Proto    $http_x_forwarded_proto;
    uwsgi_read_timeout 300;
}

gzip on;
gzip_disable "msie6";
gzip_vary on;
gzip_proxied any;
gzip_comp_level 5;
gzip_buffers 16 8k;
gzip_http_version 1.1;
gzip_min_length 256;
gzip_types application/atom+xml application/javascript application/json application/ld+json
    application/manifest+json application/rss+xml application/vnd.geo+json
    application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json
    application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml
    image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc
    text/vtt text/x-component text/x-cross-domain-policy;
